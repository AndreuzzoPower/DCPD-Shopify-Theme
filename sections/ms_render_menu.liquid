{%- comment -%}
  MS Render Menu
  ═══════════════════════════════════════════════════════════════
  Renderizza un menu di navigazione come lista di link stilizzati.
  L'utente seleziona un menu da Shopify Admin e viene renderizzato
  con stile, allineamento e layout configurabili.
  CSS dedicato: assets/ms_render-menu.css
  Blocchi ms_section-style per padding, margin e background.
{%- endcomment -%}

{{ 'ms_render-menu.css' | asset_url | stylesheet_tag }}

{%- if section.settings.menu != blank -%}
  {%- assign menu = linklists[section.settings.menu] -%}
  {%- if menu.links.size > 0 -%}

    {%- liquid
      assign title_tag = section.settings.title_tag | default: 'div'
      assign title_classes = 'ms-render-menu__title h3'
      if section.settings.title_custom_class != blank
        assign title_classes = title_classes | append: ' ' | append: section.settings.title_custom_class
      endif
    -%}

    <div
      class="ms-render-menu ms-render-menu--align-{{ section.settings.alignment }} ms-render-menu--{{ section.settings.style }} color-{{ section.settings.color_scheme }} gradient"
      id="section-{{ section.id }}"
    >
      {%- if section.settings.section_width != 'full_width' -%}
        <div class="page-width">
      {%- endif -%}

        {%- if section.settings.show_title and section.settings.title != blank -%}
          <{{ title_tag }} class="{{ title_classes }}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}">
            {{ section.settings.title }}
          </{{ title_tag }}>
        {%- endif -%}

        <nav aria-label="{{ section.settings.title | default: 'Navigazione menu' | escape }}">
          <ul
            class="ms-render-menu__list{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
            role="list"
          >
            {%- for link in menu.links -%}
              {%- liquid
                assign is_active = false
                if request.path == link.url
                  assign is_active = true
                endif
              -%}
              <li>
                <a
                  href="{{ link.url }}"
                  class="ms-render-menu__link{% if is_active %} ms-render-menu__link--active{% endif %}"
                  {% if is_active %}aria-current="page"{% endif %}
                >
                  {{- link.title -}}
                </a>
              </li>
            {%- endfor -%}
          </ul>
        </nav>

      {%- if section.settings.section_width != 'full_width' -%}
        </div>
      {%- endif -%}
    </div>

  {%- endif -%}
{%- endif -%}

{%- render 'ms_section-style' -%}

{% schema %}
{
  "name": "MS Render Menu",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Menu"
    },
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu navigazione",
      "info": "Seleziona un menu di navigazione creato in Shopify Admin > Navigazione."
    },
    {
      "type": "header",
      "content": "Intestazione"
    },
    {
      "type": "checkbox",
      "id": "show_title",
      "default": false,
      "label": "Mostra titolo"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Titolo"
    },
    {
      "type": "select",
      "id": "title_tag",
      "label": "Tag titolo",
      "options": [
        { "label": "H1", "value": "h1" },
        { "label": "H2", "value": "h2" },
        { "label": "H3", "value": "h3" },
        { "label": "H4", "value": "h4" },
        { "label": "H5", "value": "h5" },
        { "label": "H6", "value": "h6" },
        { "label": "Paragrafo", "value": "p" },
        { "label": "Div", "value": "div" }
      ],
      "default": "div"
    },
    {
      "type": "text",
      "id": "title_custom_class",
      "label": "Classe CSS personalizzata titolo",
      "info": "Classe aggiuntiva (opzionale). Le classi esistenti (h3) vengono mantenute."
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Section Width",
      "options": [
        { "label": "Full Width", "value": "full_width" },
        { "label": "Default Width", "value": "default" },
        { "label": "Page width", "value": "page_width" }
      ],
      "default": "page_width"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Allineamento",
      "default": "left",
      "options": [
        { "value": "left", "label": "Sinistra" },
        { "value": "center", "label": "Centro" },
        { "value": "right", "label": "Destra" }
      ]
    },
    {
      "type": "header",
      "content": "Stile"
    },
    {
      "type": "select",
      "id": "style",
      "label": "Stile link",
      "default": "pills",
      "options": [
        { "value": "pills", "label": "Pillole (arrotondati)" },
        { "value": "buttons", "label": "Bottoni (squadrati)" },
        { "value": "underline", "label": "Sottolineato" },
        { "value": "plain", "label": "Semplice" }
      ]
    },
    {
      "type": "header",
      "content": "Colore"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "blocks": [
    {
      "type": "section_padding",
      "name": "Section Padding",
      "limit": 1,
      "settings": [
        {
          "type": "header",
          "content": "Large/Desktop Device"
        },
        {
          "type": "range",
          "id": "section_padding_top",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_padding_bottom",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Bottom",
          "unit": "px",
          "default": 20
        },
        {
          "type": "header",
          "content": "Tablet Device"
        },
        {
          "type": "range",
          "id": "section_padding_top_md",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_padding_bottom_md",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Bottom",
          "unit": "px",
          "default": 15
        },
        {
          "type": "header",
          "content": "Mobile Device"
        },
        {
          "type": "range",
          "id": "section_padding_top_xs",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_padding_bottom_xs",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Padding Bottom",
          "unit": "px",
          "default": 10
        }
      ]
    },
    {
      "type": "section_margin",
      "name": "Section Margin",
      "limit": 1,
      "settings": [
        {
          "type": "header",
          "content": "Large/Desktop Device"
        },
        {
          "type": "range",
          "id": "section_margin_top",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_margin_bottom",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Bottom",
          "unit": "px",
          "default": 0
        },
        {
          "type": "header",
          "content": "Tablet Device"
        },
        {
          "type": "range",
          "id": "section_margin_top_md",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_margin_bottom_md",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Bottom",
          "unit": "px",
          "default": 0
        },
        {
          "type": "header",
          "content": "Mobile Device"
        },
        {
          "type": "range",
          "id": "section_margin_top_xs",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Top",
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "section_margin_bottom_xs",
          "min": 0,
          "max": 150,
          "step": 5,
          "label": "Margin Bottom",
          "unit": "px",
          "default": 0
        }
      ]
    },
    {
      "type": "section_background",
      "name": "Section Background",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "section_bg_image",
          "label": "BG Image"
        },
        {
          "type": "color",
          "id": "section_bg_color",
          "label": "BG Color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "MS Render Menu",
      "category": "Navigazione",
      "blocks": [
        {
          "type": "section_padding"
        }
      ]
    }
  ]
}
{% endschema %}
